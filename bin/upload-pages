#!/usr/bin/env bash

set -euxo pipefail

if [[ -z ${GITHUB_ACTIONS+x} ]]; then
  echo "var is unset"
  COMMIT=`git rev-parse HEAD`
else
  COMMIT=$GITHUB_SHA
fi

cd gallery
git init --initial-branch pages
if [[ ! -z ${GITHUB_ACTIONS+x} ]]; then
  git config user.email '<>'
  git config user.name 'GitHub Actions'
fi
touch .nojekyll
git add .
git commit --message "Pages build $COMMIT"
git push --force git@github.com:casey/degenerate.git
